{% if is_granted('IS_AUTHENTICATED_REMEMBERED') %}
<nav class="mb-6 border-b border-slate-200 bg-white/80 backdrop-blur dark:border-slate-800 dark:bg-slate-900/70">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="flex h-14 items-center justify-between">
      <a class="font-semibold text-slate-800 hover:text-primary dark:text-slate-100" href="{{ path('app_home') }}">
        MiniRéseau
      </a>

      <button id="menu-toggle"
              class="inline-flex items-center justify-center rounded-md p-2 text-slate-600 hover:bg-slate-100 hover:text-slate-900 dark:text-slate-300 dark:hover:bg-slate-800 dark:hover:text-white lg:hidden"
              aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>

      <div id="mainNavbar" class="hidden w-full grow items-center justify-between gap-4 lg:flex">
        <ul class="mt-3 flex flex-col gap-2 lg:mt-0 lg:flex-row lg:items-center">
          <li><a class="px-3 py-2 text-slate-700 hover:text-primary dark:text-slate-200" href="{{ path('app_home') }}">Accueil</a></li>
          <li>
            <a class="inline-flex items-center rounded-md bg-black px-3 py-2 text-sm font-medium text-white hover:bg-indigo-600"
               href="{{ path('app_message_add') }}">Créer un message</a>
          </li>
          {% if is_granted('ROLE_ADMIN') %}
            <li><a class="px-3 py-2 text-slate-700 hover:text-primary dark:text-slate-200" href="{{ path('admin_comments_index') }}">Commentaires (Admin)</a></li>
            <li><a class="px-3 py-2 text-slate-700 hover:text-primary dark:text-slate-200" href="{{ path('admin_users_index') }}">Utilisateurs (Admin)</a></li>
          {% endif %}
        </ul>

        <ul class="flex items-center gap-3">
      <li class="hidden sm:block">
        <span class="text-xs text-slate-500 dark:text-slate-400">{{ app.user.username ?? app.user.email }}</span>
      </li>
      <li>
        <a class="inline-flex items-center rounded-md border border-slate-300 px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-100 dark:border-slate-700 dark:text-slate-200 dark:hover:bg-slate-800"
           href="{{ path('app_logout') }}">Se déconnecter</a>
      </li>
    </ul>
  </div>

  <script>
    (function(){
      const btn = document.getElementById('menu-toggle');
      const nav = document.getElementById('mainNavbar');
      if (btn && nav) {
        btn.addEventListener('click', () => nav.classList.toggle('hidden'));
      }

      const darkBtn = document.getElementById('dark-toggle');
      if (darkBtn) {
        darkBtn.addEventListener('click', () => {
          const isDark = document.documentElement.classList.toggle('dark');
          localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });
      }
    })();
  </script>
</nav>
{% endif %}